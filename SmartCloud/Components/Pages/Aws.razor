@page "/aws"
@using Blazored.Toast.Configuration
@inject Jenkins jenkins
@inject IToastService toastService
<h1>
    <span class="bi aws-page-icon ms-3"></span>
</h1>
<BlazoredToasts Position="ToastPosition.TopRight" Timeout="2" MaxToastCount="3"/>

<PermutationsTable OnOrder="HandleOrder"></PermutationsTable>
@code
{
    private int _errors;

    private async void HandleOrder(OrderPermutation permutation)
    {
        Console.WriteLine($"Ordering Machine in AWS, {permutation}");
        try
        {
            await jenkins.OrderPermutation(permutation);
            toastService.ShowSuccess("Successfully Ordered Machine");
        }
        catch (Exception)
        {
            _errors += 1;
            toastService.ShowError("Failed To Order Machine");
            Console.WriteLine($"Failed to request machine, errors {_errors}");
        }
    }
}